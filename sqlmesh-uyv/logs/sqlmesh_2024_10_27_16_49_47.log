2024-10-27 16:49:47,564 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'db.db'} (connection.py:322)
2024-10-27 16:49:48,601 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:324)
2024-10-27 16:49:48,691 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: db.db (connection.py:318)
2024-10-27 16:49:58,382 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__sqlmesh_example (evaluator.py:273)
2024-10-27 16:49:58,383 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2022)
2024-10-27 16:49:58,385 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2022)
2024-10-27 16:49:58,390 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE (table_catalog = 'db' AND table_schema = 'sqlmesh__sqlmesh_example') AND table_name IN ('sqlmesh_example__seed_model__3637577337__temp', 'sqlmesh_example__incremental_model__4079113854__temp', 'sqlmesh_example__full_model__3438509882', 'sqlmesh_example__incremental_model__4079113854', 'sqlmesh_example__full_model__3438509882__temp', 'sqlmesh_example__seed_model__3637577337') (base.py:2022)
2024-10-27 16:49:58,453 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh__sqlmesh_example' (evaluator.py:898)
2024-10-27 16:49:58,453 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh__sqlmesh_example" (base.py:2022)
2024-10-27 16:49:58,455 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__seed_model__3637577337' (evaluator.py:1188)
2024-10-27 16:49:58,456 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__3637577337" ("id" INT, "item_id" INT, "event_date" DATE) (base.py:2022)
2024-10-27 16:49:58,488 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__3637577337" AS SELECT CAST("id" AS INT) AS "id", CAST("item_id" AS INT) AS "item_id", CAST("event_date" AS DATE) AS "event_date" FROM (SELECT "id", "item_id", "event_date" FROM "db"."sqlmesh__sqlmesh_example"."__temp_sqlmesh_example__seed_model__3637577337_c1fjthxm") AS "_subquery" (base.py:2022)
2024-10-27 16:49:58,490 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "db"."sqlmesh__sqlmesh_example"."__temp_sqlmesh_example__seed_model__3637577337_c1fjthxm" (base.py:2022)
2024-10-27 16:49:58,521 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__4079113854' (evaluator.py:1188)
2024-10-27 16:49:58,523 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__4079113854" ("id" INT, "item_id" INT, "event_date" DATE, "new_col" TEXT) (base.py:2022)
2024-10-27 16:49:58,523 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dry running model 'sqlmesh_example.incremental_model' (evaluator.py:1210)
2024-10-27 16:49:58,525 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT "seed_model"."id" AS "id", "seed_model"."item_id" AS "item_id", "seed_model"."event_date" AS "event_date", 'z' AS "new_col" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__3637577337" AS "seed_model" WHERE ("seed_model"."event_date" <= CAST('1970-01-01' AS DATE) AND "seed_model"."event_date" >= CAST('1970-01-01' AS DATE)) AND FALSE LIMIT 0 (base.py:2022)
2024-10-27 16:49:58,535 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Promoting environment 'prod' (engine_adapter.py:259)
2024-10-27 16:49:58,572 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Altering table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__3438509882' (evaluator.py:1234)
2024-10-27 16:49:58,572 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3438509882" (base.py:2022)
2024-10-27 16:49:58,576 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3438509882__temp" (base.py:2022)
2024-10-27 16:49:58,602 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Pausing snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 967845188> (engine_adapter.py:451)
2024-10-27 16:49:58,603 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Unpausing snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 228279443> (engine_adapter.py:428)
2024-10-27 16:49:58,603 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Unpausing snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 3974465063> (engine_adapter.py:428)
2024-10-27 16:49:58,612 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh_example' (evaluator.py:898)
2024-10-27 16:49:58,612 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh_example" (base.py:2022)
2024-10-27 16:49:58,613 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example.incremental_model' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__4079113854' (evaluator.py:1154)
2024-10-27 16:49:58,614 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."sqlmesh_example"."incremental_model" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__4079113854" (base.py:2022)
2024-10-27 16:49:58,618 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example.full_model' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__3438509882' (evaluator.py:1154)
2024-10-27 16:49:58,619 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."sqlmesh_example"."full_model" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3438509882" (base.py:2022)
2024-10-27 16:49:58,621 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Finalizing environment 'prod' (engine_adapter.py:380)
2024-10-27 16:49:58,665 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
